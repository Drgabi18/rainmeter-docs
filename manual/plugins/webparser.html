---
layout: manual
title: 'WebParser plugin'
---
<!--{% comment %}--><base href="../../"><script src="js/_local.js"></script><!--{% endcomment %}-->

<p><code>Plugin=WebParser</code> reads information from webpages.</p>

<p>The plugin uses <a href="http://www.regular-expressions.info/tutorial.html">Regular Expressions</a> to extract information from any web page or <a href="#Local">local file</a>. The plugin can be used to get current TV shows, weather conditions, stock exchange values, news and basically anything that is on the internet (provided session-based <a href="#Authentication">authenication</a> is <b>not</b> required).</p>

<p>More information and examples for WebParser can be found at <a href="http://rainmeter.net/cms/Tips-WebParserPrimer">WebParser Primer</a> and <a href="http://rainmeter.net/cms/Rainmeter101-Tutorial4">RSS Skin Tutorial</a>.</p>

<h2>Options</h2>
<dl>
	<dt>General measure options</dt>
	<dd>
		All <a href="/manual/measures/general-options">general measure options</a> are valid.
	</dd>


	<dt id="URL"><code>URL</code></dt>
	<dd>
		<p><a href="http://en.wikipedia.org/wiki/Uniform_resource_locator">URL</a> to the file to be downloaded and parsed. The <code>URL</code> can also be another WebParser measure, in which case the already downloaded and parsed information can be reused (e.g. when displaying different <code>StringIndex</code> on the same page). For example: <code>URL=[ParentMeasure]</code></p>

		<p id="Authentication">WebParser <b>cannot</b> use cookies or other session-based authentication, so it <b>cannot</b> be used to retrieve information from web sites where you must be logged in. However, Webparser <b>can</b> be used on sites which support HTTP authentication. For example: <code>http://myname:mypassword@somesite.com</code>.</p>

		<p id="Local">WebParser can read and parse local files on your computer by using the <code>file://</code> <a href="http://en.wikipedia.org/wiki/File_URI_scheme">scheme</a>. For example: <code>URL=file://C:\path\file.ext</code>.</p>
	</dd>

	<dt id="RegExp"><code>RegExp</code></dt>
	<dd>
		<p>The regular expression used in parsing. The plugin uses <a href="http://www.pcre.org/">Perl Compatible Regular Expressions</a>, so check the <a href="http://www.perl.com/doc/manual/html/pod/perlre.html">Perl docs</a> for syntax and more info.</p>
		
		<p><b>Note:</b> <code>RegExp</code> can be used on "child" WebParser measures.</p>
	</dd>

	<dt id="FinishAction"><code>FinishAction</code></dt>
	<dd>
		A <a href="/manual/bangs">bang</a> or <a href="/manual/options#action">action</a> that is executed when the page has been downloaded and the parsing is done. This setting is only valid on WebParser measures that connect to a <code>URL</code>, and actions will not be fired on "child" WebParser measures that use another measure as the <code>URL</code> (i.e. <code>URL=[SomeMeasure]</code>).
	</dd>
	
	<dt id="StringIndex"><code>StringIndex</code></dt>
	<dd>
		Defines which string from the <code>RegExp</code> this measure returns. You can get the correct index values by setting <code>Debug=1</code>, which will add all matched strings to the <a>log</a>.
	</dd>
	
	<dt id="StringIndex2"><code>StringIndex2</code></dt>
	<dd>
		<p>The second string index is used when using a <code>RegExp</code> in a measure that uses data from another WebParser measure (i.e. the <code>URL</code> points to a measure and not to a real <code>URL</code>). In this case the <code>StringIndex</code> defines the index of the result of the other <code>RegExp</code> and the <code>StringIndex2</code> defines the index of this measure's <code>RegExp</code> (i.e. it defines the string that the measure returns).</p>

		<p><b>Note:</b> If the <code>RegExp</code> is not defined in this measure, the <code>StringIndex2</code> has no effect.</p>
	</dd>
	
	<dt id="UpdateRate"><code>UpdateRate</code> <span>Default: <code>600</code></span></dt>
	<dd>
		<p>The rate how often the webpage is downloaded. This is relative to the config's main <code>Update</code> rate <b>and</b> any <code>UpdateDivider</code> on the measure. So the formula would be <code>Update</code> X <code>UpdateDivider</code> X <code>UpdateRate</code> = "how often the measure connects to the site". The default for <code>UpdateDivider</code> is 1, and the default for <code>UpdateRate</code> is 600. So if you set an <code>Update</code> of 1000, the default for WebParser is to connect every 10 minutes. (1000 X 1 X 600 milliseconds)</p>

		<p>It is advisable to limit the rate so that the server does not get flooded with constant requests. Web server admins will not like it and you may well get banned from a server altogether if you try to poll the server too often. This is why a default of 600 is set for <code>UpdateRate</code>. You can override this and make it shorter, but it is advisable (and polite) to only hit websites as often as really needed.</p>

		<p>You can use a combination of <code>UpdateDivider</code> and <code>UpdateRate</code> to both limit both how often you hit the website and how often Rainmeter updates the values returned by the measure and used by meters. However, In general practice it is often best to just set an <code>UpdateRate</code> and leave <code>UpdateDivider</code> off, so there is no lag between the measure obtaining information from the website and its display in your skin.</p>
	</dd>
	
	<dt id="DecodeCharacterReference"><code>DecodeCharacterReference</code> <span>Default: <code>0</code></span></dt>
	<dd>
		<p>Automatically decodes <a href="http://en.wikipedia.org/wiki/List_of_XML_and_HTML_character_entity_references">HTML Character References</a>. This will eliminate the need to use a <a href="/manual/measures/general-options/substitute"><code>Substitute</code></a> statement to translate character references like <code>&amp;quot;</code>, <code>&amp;amp;</code>, <code>&amp;lt;</code>, and <code>&amp;gt;</code> to the actual character. Valid values are:</p>
		<ul>
			<li><code>0</code>: Does nothing (default).</li>
			<li><code>1</code>: Decodes both numeric character references and character entity references.</li>
			<li><code>2</code>: Decodes only numeric character references.</li>
			<li><code>3</code>: Decodes only character entity references.</li>
		</ul>
	</dd>
	
	<dt id="Debug"><code>Debug</code> <span>Default: <code>0</code></span></dt>
	<dd>
		<p>Logs DEBUG messages to the Rainmeter <a>log</a> or to a file. Valid values are:</p>
		<ul>
			<li><code>0</code>: Does not log DEBUG messages from WebParser.</li>
			<li><code>1</code>: Logs DEBUG message to the log. Rainmeter must also be in <a href="/manual/settings/rainmeter-section#Debug">Debug</a> mode.</li>
			<li><code>2</code>: Saves the downloaded webpage to <code>C:\WebParserDump.txt</code>. This can be useful since some web servers send different information depending which client requests it. Remember to remove this from your config once you have it working correctly.</li>
		</ul>
	</dd>
	
	<dt id="Debug2File"><code>Debug2File</code></dt>
	<dd>
		<p>If <code>Debug=2</code>, then the parameter will allow you to set the path <b>and</b> filename of the file to use for the downloaded webpage (instead of <code>C:\WebParserDump.txt</code>). This will allow you to use WebParser to parse the local version for testing, or for use in another measure or skin.</p>
			
		<p><b>Notes:</b> The directory must already exist.</p>
		
		<p><b>Usage:</b></p>
{% highlight ini %}
[WebParserMeasure]
Measure=Plugin
Plugin=WebParser
....
Debug2File="C:\filename.txt"
Debug=2

[WebParserMeasure2]
Measure=Plugin
Plugin=WebParser
....
; Saves to current skin folder
Debug2File="Debug2File.txt"
Debug=2
{% endhighlight %}
	</dd>
	
	<dt id="Download"><code>Download</code> <span>Default: <code>0</code></span></dt>
	<dd>
		If <code>Download=1</code>, the <code>URL</code> is downloaded to a temporary folder and the name to the file is returned as string value. The measure can be bound to a <a href="/manual/meters/image">Image</a> meter to download images from web and show them. If the <code>RegExp</code> is defined, the parsed string is interpreted as a link to the downloaded image.
	</dd>
	
	<dt id="DownloadFile"><code>DownloadFile</code></dt>
	<dd>
		<p>When <code>Download=1</code>, the file is downloaded to a <code>DownloadFile</code> folder in the skin folder as a filename set to this value.</p>
		
		<p>For example, if you define <code>DownloadFile=image.jpg</code>, a <code>DownloadFile</code> folder will be created in the current skin folder then the downloaded file is saved as <code>image.jpg</code>. However, if you define as <code>DownloadFile=photo\image.jpg</code>, the subfolder <code>photo</code> is created then the file is saved in this folder.</p>
		
		<p><b>Note:</b> This file is <b>not</b> a temporary file so it is <b>not</b> deleted even after closing a skin. Also, it is not possible to specify an absolute path.</p>

	</dd>
	
	<dt id="ErrorString"><code>ErrorString</code></dt>
	<dd>
		 String that is returned in case there is a parse error.
	</dd>
	
	<dt id="ForceReload"><code>ForceReload</code> <span>Default: <code>0</code></span></dt>
	<dd>
		 WebParser reads the resource only if it has been modified. This can be overridden with <code>ForceReload=1</code>.
	</dd>
	
	<dt id="ProxyServer"><code>ProxyServer</code></dt>
	<dd>
		<p>Name of the proxy server. The plugin doesn't support any authentication, so <b>only</b> use servers that does not require it or you need a some different way to authenticate yourself to the proxy server.</p>

		<p><b>Examples:</b> <code>ProxyServer=ServerIP:Port</code>, <code>ProxyServer=ServerName:Port</code></p>
	</dd>
	
	<dt id="CodePage"><code>CodePage</code> <span>Default: <code>0</code></span></dt>
	<dd>
		 <p>Defines the codepage of the downloaded web page. For example: <code>CodePage=28605</code> interprets the page as <code>Latin 9 (ISO-8859-15)</code>. <code>CodePage=65001</code> means <code>UTF-8</code>. <code>CodePage=0</code> means no conversion is done.</p>
		 
		 <p><a href="http://www.microsoft.com/globaldev/reference/wincp.mspx">Here</a> is a list of other Windows code pages.</p>
	</dd>
</dl>

<h2>Examples</h2>

<p>Retrieve the title and first item from Slashdot's RSS feed.</p>

{% highlight ini %}
[MeasureRSSTitle]
Measure=Plugin
Plugin=WebParser
UpdateRate=3600
URL=http://slashdot.org/slashdot.rdf
RegExp="(?siU)<title>(.+)</title>(.+)<item(.+)<title>(.+)</title>"
StringIndex=1
FinishAction=!Redraw

[MeasureRSS]
Measure=Plugin
Plugin=WebParser
URL=[MeasureRSSTitle]
StringIndex=4
Substitute="&amp;":"&"
{% endhighlight %}

<p>Download the current weather map from Finnish Meteorological Institute.</p>

{% highlight ini %}
[MeasureDL]
Measure=Plugin
Plugin=WebParser
UpdateRate=1800
URL=http://www.fmi.fi/saa/sadejapi_5.html?selected=7
RegExp="(?siU)ennuste" SRC=\"(.*)\"></TD>"
FinishAction=!Redraw
StringIndex=1
Download=1

[MeterImage]
Meter=IMAGE
MeasureName=MeasureDL
X=0
Y=0
W=400
H=300
{% endhighlight %}